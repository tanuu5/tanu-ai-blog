<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>モダンビンゴアプリ</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f4f8;
            color: #333;
        }
        .container {
            background-color: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            max-width: 90%;
            width: 450px;
        }
        #bingo-board {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin-top: 20px;
        }
        .cell {
            aspect-ratio: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s ease;
            background-color: #e0e7ff;
            color: #4a5568;
        }
        .cell:hover {
            transform: scale(1.05);
        }
        .cell.open {
            background-color: #68d391;
            color: white;
        }
        .cell.highlight {
            background-color: #fbd38d;
            color: #744210;
        }
        #free-space {
            background-color: #68d391;
            color: white;
        }
        .controls {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            justify-content: space-between;
            align-items: center;
        }
        input, button {
            padding: 10px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
        }
        input {
            width: 100px;
            background-color: #e2e8f0;
        }
        button {
            background-color: #4299e1;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #3182ce;
        }
        #generation-time {
            text-align: center;
            margin-top: 20px;
            font-style: italic;
            color: #718096;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="controls">
            <input type="number" id="max-number" value="75" min="25" max="99" placeholder="最大数">
            <button id="generate-btn">ビンゴを生成</button>
        </div>
        <div id="bingo-board"></div>
        <div id="generation-time"></div>
    </div>

    <script>
        const board = document.getElementById('bingo-board');
        const generateBtn = document.getElementById('generate-btn');
        const maxNumberInput = document.getElementById('max-number');
        const generationTimeDiv = document.getElementById('generation-time');
        let cells = [];

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function createBoard() {
            board.innerHTML = '';
            cells = [];
            const maxNumber = parseInt(maxNumberInput.value) || 75;
            const numbers = Array.from({length: maxNumber}, (_, i) => i + 1);
            const shuffled = shuffle(numbers);

            for (let i = 0; i < 25; i++) {
                const cell = document.createElement('div');
                cell.className = 'cell';
                if (i === 12) {
                    cell.id = 'free-space';
                    cell.textContent = 'FREE';
                    cell.classList.add('open');
                } else {
                    cell.textContent = shuffled[i];
                }
                cell.addEventListener('click', () => toggleCell(cell));
                board.appendChild(cell);
                cells.push(cell);
            }

            updateGenerationTime();
        }

        function toggleCell(cell) {
            if (cell.id !== 'free-space') {
                cell.classList.toggle('open');
                checkBingo();
            }
        }

        function checkBingo() {
            const lines = [
                [0,1,2,3,4], [5,6,7,8,9], [10,11,12,13,14], [15,16,17,18,19], [20,21,22,23,24], // 横
                [0,5,10,15,20], [1,6,11,16,21], [2,7,12,17,22], [3,8,13,18,23], [4,9,14,19,24], // 縦
                [0,6,12,18,24], [4,8,12,16,20] // 斜め
            ];

            lines.forEach(line => {
                if (line.every(index => cells[index].classList.contains('open'))) {
                    line.forEach(index => cells[index].classList.add('highlight'));
                } else {
                    line.forEach(index => cells[index].classList.remove('highlight'));
                }
            });
        }

        function updateGenerationTime() {
            const now = new Date();
            const formattedTime = now.toLocaleString('ja-JP', { 
                year: 'numeric', 
                month: '2-digit', 
                day: '2-digit', 
                hour: '2-digit', 
                minute: '2-digit', 
                second: '2-digit' 
            });
            generationTimeDiv.textContent = `生成日時: ${formattedTime}`;
        }

        generateBtn.addEventListener('click', createBoard);
        createBoard();
    </script>
</body>
</html>
